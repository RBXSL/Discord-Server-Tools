import discord
from discord.ext import commands
import asyncio

# ---------- CONFIG ----------
TRIGGER = ""       # Command to trigger webhook creation
WEBHOOK_NAME = ""      # Name of the webhook
GUILD_ID = 12345678   # Your server ID
CHANNEL_ID = 1234567890 # Channel to create the webhook in
# ----------------------------

intents = discord.Intents.default()
intents.guilds = True
intents.message_content = True

bot = commands.Bot(command_prefix="", intents=intents)

@bot.event
async def on_ready():
    print(f"Logged in as {bot.user}")

async def create_webhook(channel, name):
    try:
        webhook = await channel.create_webhook(name=name)
        print(f"Created webhook: {webhook.name}")
        print(f"Webhook URL: {webhook.url}")  # This is your webhook URL
        return webhook.url
    except discord.Forbidden:
        print(f"No permission to create webhook in {channel.name}")
    except discord.HTTPException as e:
        print(f"Failed to create webhook: {e}")

@bot.event
async def on_message(message):
    if message.author.bot:
        return

    if message.content.lower().strip() == TRIGGER.lower():
        guild = bot.get_guild(GUILD_ID)
        if not guild:
            print("Bot is not in the specified guild.")
            return

        channel = guild.get_channel(CHANNEL_ID)
        if not channel:
            print("Channel not found.")
            return

        webhook_url = await create_webhook(channel, WEBHOOK_NAME)
        if webhook_url:
            try:
                await message.author.send(f"Webhook created!\nURL: {webhook_url}")
            except discord.Forbidden:
                print("Couldn't DM the user.")

bot.run("Webhook_Here")
